<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>รายงานค่าฝุ่น PM 2.5 - ทุกจังหวัด</title>
  <!-- SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    body {
      font-family: "Poppins", Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #ffffff; /* พื้นหลังเว็บไซต์ */
      color: #333;
    }
    header {
      background: #228B22; /* สีเขียวเข้ม */
      color: white;
      padding: 20px;
      text-align: center;
      border-radius: 0 0 20px 20px;
      box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    }
    header h1 {
      font-size: 2em;
      margin: 0;
    }
    header p {
      font-size: 1em;
      margin: 5px 0 0;
    }
    table {
      width: 90%;
      margin: 20px auto;
      border-collapse: separate;
      border-spacing: 0 10px; /* ระยะห่างระหว่างแถว */
    }
    table th {
      padding: 15px;
      text-align: center;
      font-size: 1.2em;
      background: #228B22; /* สีเขียวเข้ม */
      color: white;
      border-radius: 10px 10px 0 0;
    }
    table td {
      padding: 15px;
      text-align: center;
      border-radius: 10px;
      font-size: 1em;
      color: white;
    }
    .level-good {
      background: #008000; /* สีเขียว */
    }
    .level-moderate {
      background: #4682B4; /* สีน้ำเงิน */
    }
    .level-unhealthy-sensitive {
      background: #FF8C00; /* สีส้ม */
    }
    .level-unhealthy {
      background: #FF4500; /* สีแดง */
    }
    .level-very-unhealthy {
      background: #800080; /* สีม่วง */
    }
    footer {
      text-align: center;
      padding: 20px;
      background: #333;
      color: white;
      margin-top: 20px;
      border-radius: 20px 20px 0 0;
    }
    footer p {
      margin: 0;
    }
  </style>
</head>
<body>
  <header>
    <h1>รายงานค่าฝุ่น PM 2.5</h1>
    <p>อัปเดตล่าสุด: <span id="update-time"></span></p>
  </header>

  <table>
    <thead>
      <tr>
        <th>จังหวัด</th>
        <th>ค่า PM 2.5</th>
        <th>ระดับความอันตราย</th>
      </tr>
    </thead>
    <tbody id="pm-table">
      <tr>
        <td colspan="3">กำลังโหลดข้อมูล...</td>
      </tr>
    </tbody>
  </table>

  <footer>
    <p>ข้อมูลจาก OpenWeatherMap API</p>
  </footer>

  <script>
    const provinces = [
      "กรุงเทพมหานคร", "เชียงใหม่", "ขอนแก่น", "ภูเก็ต", "นครราชสีมา", "สุรินทร์", "ระยอง"
    ]; // ตัวอย่างจังหวัด
    const apiKey = "41c1aef7e4e507e010fb4e2705e6f0b6";
    const tableBody = document.getElementById("pm-table");
    const updateTime = document.getElementById("update-time");

    async function fetchAirQuality() {
      tableBody.innerHTML = "";
      const now = new Date();
      updateTime.textContent = now.toLocaleString();

      for (const province of provinces) {
        try {
          // ตัวอย่างข้อมูลแบบสมมุติ (กำหนด PM 2.5 โดยไม่ดึงข้อมูลจริง)
          const pm25 = Math.floor(Math.random() * 300); // สุ่มค่า PM 2.5
          const level = getPmLevel(pm25);

          const row = `
            <tr class="${level.class}">
              <td>${province}</td>
              <td>${pm25}</td>
              <td>${level.label}</td>
            </tr>
          `;
          tableBody.innerHTML += row;
        } catch (error) {
          Swal.fire({
            icon: 'error',
            title: 'เกิดข้อผิดพลาด',
            text: `ไม่สามารถโหลดข้อมูลของ ${province} ได้`,
          });
        }
      }
    }

    function getPmLevel(pm25) {
      if (pm25 <= 50) return { label: "ดี", class: "level-good" };
      if (pm25 <= 100) return { label: "ปานกลาง", class: "level-moderate" };
      if (pm25 <= 150) return { label: "เริ่มมีผลกระทบ", class: "level-unhealthy-sensitive" };
      if (pm25 <= 200) return { label: "อันตราย", class: "level-unhealthy" };
      return { label: "อันตรายมาก", class: "level-very-unhealthy" };
    }

    fetchAirQuality();
  </script>
</body>
</html>
